{{ 'component-slider.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-article-card.css' | asset_url | stylesheet_tag }}
{{ 'section-featured-blog.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

{%- liquid
  assign posts_displayed = section.settings.blog.articles_count
  if section.settings.post_limit <= section.settings.blog.articles_count or section.settings.post_limit <= 4
    assign posts_exceed_limit = true
    assign posts_displayed = section.settings.post_limit
  endif
-%}
<div class="blog color-{{ section.settings.color_scheme }} gradient{% if section.settings.show_top_border %} main-top__border{% endif %}{% if section.settings.show_bottom_border %} main-bottom__border{% endif %}">
  <div class="page-width isolate{% if posts_displayed < 3 %} page-width-tablet{% endif %} section-{{ section.id }}-padding">
    <div class="blog-top">
      {%- if section.settings.heading != blank or section.settings.link_title != blank -%}
        <div class="blog-top__top">
          {%- if section.settings.heading != blank -%}
            <h4
              id="SectionHeading-{{ section.id }}"
              class="blog-title inline-richtext {{ section.settings.heading_size }}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
              {% if settings.animations_reveal_on_scroll %}
              data-cascade
              {% endif %}>
              {{ section.settings.heading }}
            </h4>
          {%- endif -%}
          {%- if section.settings.link_title != blank -%}
            <a class="blog-link link-arrow" href="{{ section.settings.link_url }}">
              <span class="">
                {{ section.settings.link_title }}
              </span>
              {% render 'icon-link-arrow' %}
            </a>
          {%- endif -%}
        </div>
      {%- endif -%}

      <slider-component class="blog-slider slider-mobile-gutter{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
        <ul
          id="Slider-{{ section.id }}"
          class="blog__posts articles-wrapper contains-card contains-card--article{% if settings.blog_card_style == 'standard' %} contains-card--standard{% endif %} grid grid--peek grid--2-col-tablet grid--{{ section.settings.columns_desktop }}-col-desktop slider {% if posts_displayed > 2 %}slider--tablet{% else %}slider--mobile{% endif %}"
          role="list">
          {%- if section.settings.blog != blank and section.settings.blog.articles_count > 0 -%}
            {%- for article in section.settings.blog.articles limit: section.settings.post_limit -%}
              <li
                id="Slide-{{ section.id }}-{{ forloop.index }}"
                class="blog__post grid__item article slider__slide slider__slide--full-width{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
                {% if settings.animations_reveal_on_scroll %}
                data-cascade
                style="--animation-order: {{ forloop.index }};"
                {% endif %}>
                {% render 'article-card'
                  , blog: section.settings.blog
                  , article: article
                  , media_aspect_ratio: 1.66
                  , show_image: section.settings.show_image
                  , show_date: section.settings.show_date
                  , show_author: section.settings.show_author
                  , show_excerpt: section.settings.show_excerpt
                %}
              </li>
            {%- endfor -%}
          {%- else -%}
            {% for i in (1..section.settings.post_limit) -%}
              {%- assign placeholder_image_index = forloop.index0 | modulo: 3 | plus: 1 -%}
              {%- assign placeholder_image = 'blog-apparel-' | append: placeholder_image_index -%}
              <li
                id="Slide-{{ section.id }}-{{ forloop.index }}"
                class="blog__post grid__item article slider__slide slider__slide--full-width{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
                {% if settings.animations_reveal_on_scroll %}
                data-cascade
                style="--animation-order: {{ forloop.index }};"
                {% endif %}>
                <div class="article-card-wrapper card-wrapper{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
                  <div class="
                    card article-card card--{{ settings.blog_card_style }}
                    {% if settings.blog_card_style == 'card' %} color-{{ settings.blog_card_color_scheme }} gradient{% endif %}
                    {% if section.settings.show_image %} card--media{% else %} card--text{% endif %}
                  " style=" {% if settings.blog_card_style == 'standard' %} --ratio-percent: 100%;{% elsif settings.blog_card_style == 'card' %} --ratio-percent: 0%;{% endif %}">
                    <div class="card__inner{% if settings.blog_card_style == 'standard' %} color-{{ settings.blog_card_color_scheme }} gradient{% endif %} ratio" style="--ratio-percent: 80%;">
                      {%- if section.settings.show_image == true -%}
                        <div class="article-card__image-wrapper card__media">
                          <div class="article-card__image media">
                            {{ placeholder_image | placeholder_svg_tag: 'blog-placeholder-svg' }}
                          </div>
                        </div>
                      {%- endif -%}
                      <div class="card__content">
                        <div class="card__information">
                          <span>Author</span>
                          <h3 class="card__heading h5">
                            {{ 'sections.featured_blog.onboarding_title' | t }}
                          </h3>
                        {% comment %} <p class="article-card__excerpt rte-width">
                                                                                                                                                                                                                                                                    {{ 'sections.featured_blog.onboarding_content' | t }}
                                                                                                                                                                                                                                                </p> {% endcomment %}
                        </div>
                      </div>
                    </div>
                    <div class="card__content">
                      <div class="card__information">
                        <span>Author</span>
                        <h3 class="card__heading h5">
                          {{ 'sections.featured_blog.onboarding_title' | t }}
                        </h3>
                      {% comment %} <p class="article-card__excerpt rte-width">
                                                                                                                                                                                                                                                {{ 'sections.featured_blog.onboarding_content' | t }}
                                                                                                                                                                                                                            </p> {% endcomment %}
                      </div>
                    </div>
                  </div>
                </div>
              </li>
            {%- endfor -%}
          {%- endif -%}
        </ul>
        {%- if posts_exceed_limit -%}
          <div class="slider-buttons no-js-hidden{% if section.settings.post_limit < 3 %} medium-hide{% endif %}{% if section.settings.post_limit < 2 %} small-hide{% endif %}">
            <button
              type="button"
              class="slider-button slider-button--prev"
              name="previous"
              aria-label="{{ 'general.slider.previous_slide' | t }}">
              {% render 'icon-caret' %}
            </button>
            <button
              type="button"
              class="slider-button slider-button--next"
              name="next"
              aria-label="{{ 'general.slider.next_slide' | t }}">
              {% render 'icon-caret' %}
            </button>
          </div>
        {%- endif -%}
      </slider-component>
    </div>
    <div class="blog-bottom">
      <div class="blog-bottom__top">
        <h4 class="blog-bottom__top--title {{ section.settings.instagram_title_size }}">
          {{ section.settings.instagram_title }}
        </h4>
        <a class="blog-bottom__top--link" href="{{ section.settings.instagram_link_url }}">
          {{ section.settings.instagram_link_title }}
        </a>
      </div>
      <div class="blog-bottom__bottom">
        {%- for block in section.blocks -%}
          {%- if block.settings.instagram_img != blank -%}
            <div class="blog-bottom__bottom--item">
              <a class="blog-bottom__bottom--link" href="{{ block.settings.instagram_img_link }}">
                <img
                  class="blog-bottom__bottom--img"
                  src="{{ block.settings.instagram_img | image_url: width: 500 }}"
                  alt="{{ block.settings.instagram_img.alt | escape }}"
                  width="250"
                  height="250">
              </a>
            </div>
          {%- endif -%}
        {% endfor %}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "t:sections.featured-blog.name",
    "tag": "section",
    "settings": [
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "t:sections.all.colors.label",
        "default": "background-1"
      },
      {
        "type": "header",
        "content": "Blog post settings"
      },
      {
        "type": "inline_richtext",
        "id": "heading",
        "default": "Blog posts",
        "label": "t:sections.featured-blog.settings.heading.label"
      },
      {
        "type": "select",
        "id": "heading_size",
        "options": [
          {
            "value": "h4",
            "label": "t:sections.all.heading_size.options__1.label"
          }, {
            "value": "h3",
            "label": "t:sections.all.heading_size.options__2.label"
          }, {
            "value": "h2",
            "label": "t:sections.all.heading_size.options__3.label"
          }
        ],
        "default": "h2",
        "label": "t:sections.all.heading_size.label"
      }, {
        "type": "text",
        "id": "link_title",
        "label": "Link title",
        "default": "Link title"
      }, {
        "type": "url",
        "id": "link_url",
        "label": "Link url"
      }, {
        "type": "blog",
        "id": "blog",
        "label": "t:sections.featured-blog.settings.blog.label"
      }, {
        "type": "range",
        "id": "post_limit",
        "min": 2,
        "max": 4,
        "step": 1,
        "default": 3,
        "label": "t:sections.featured-blog.settings.post_limit.label"
      }, {
        "type": "range",
        "id": "columns_desktop",
        "min": 1,
        "max": 4,
        "step": 1,
        "default": 3,
        "label": "t:sections.featured-blog.settings.columns_desktop.label"
      }, {
        "type": "checkbox",
        "id": "show_image",
        "default": true,
        "label": "t:sections.featured-blog.settings.show_image.label",
        "info": "t:sections.featured-blog.settings.show_image.info"
      }, {
        "type": "checkbox",
        "id": "show_date",
        "default": true,
        "label": "t:sections.featured-blog.settings.show_date.label"
      }, {
        "type": "checkbox",
        "id": "show_author",
        "default": false,
        "label": "t:sections.featured-blog.settings.show_author.label"
      }, {
        "type": "checkbox",
        "id": "show_excerpt",
        "default": false,
        "label": "Show excerpt"
      }, {
        "type": "header",
        "content": "Blog post instagram settings"
      }, {
        "type": "text",
        "id": "instagram_title",
        "label": "Heading",
        "default": "Title"
      }, {
        "type": "select",
        "id": "instagram_title_size",
        "options": [
          {
            "value": "h4",
            "label": "Small"
          }, {
            "value": "h3",
            "label": "Medium"
          }, {
            "value": "h2",
            "label": "Large"
          }
        ],
        "default": "h2",
        "label": "Heading size"
      }, {
        "type": "text",
        "id": "instagram_link_title",
        "label": "Link title",
        "default": "Link title"
      }, {
        "type": "url",
        "id": "instagram_link_url",
        "label": "Link url"
      }, {
        "type": "header",
        "content": "t:sections.all.padding.section_padding_heading"
      }, {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 200,
        "step": 2,
        "unit": "px",
        "label": "t:sections.all.padding.padding_top",
        "default": 36
      }, {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 200,
        "step": 2,
        "unit": "px",
        "label": "t:sections.all.padding.padding_bottom",
        "default": 36
      }, {
        "type": "checkbox",
        "id": "show_top_border",
        "label": "Show top border",
        "default": false
      }, {
        "type": "checkbox",
        "id": "show_bottom_border",
        "label": "Show bottom border",
        "default": false
      }
    ],
    "blocks": [
      {
        "type": "image",
        "name": "Image",
        "limit": 5,
        "settings": [
          {
            "type": "image_picker",
            "id": "instagram_img",
            "label": "Image"
          }, {
            "type": "url",
            "id": "instagram_img_link",
            "label": "Image link"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "t:sections.featured-blog.presets.name",
        "blocks": [
          {
            "type": "image"
          }
        ]
      }
    ]
  }
{% endschema %}